%li{:id => "widget_#{@column.id}"}
  .introduction.panel.margin-b30
    .body
      .cell.handle
        .section-title.float-left #{@column.name} 
        .widget-actions.float-right
          - if can? :update, @column.community            
            = link_to '添加文章', new_community_column_article_path(@column.community, @column)
            %a.widget-setting-link{:href => "#", :id => "#{@column.id}-settings"} 设置
            = link_to '删除', url_for_event(:delete_widget, :id => @column.section.id, :widget_id => @column.id), :confirm => 'Are you sure?', :method => 'delete', :remote => true

        .widget-setting{"data-id" => "#{@column.id}"}
          = form_for @column, :url => community_column_url(@column.community, @column)  do |f| 
            %p
              = f.text_field :name 
            %p
              = f.submit "保存"     
    .body
      .col.sizefill
        .cell.column
          - @column.articles.each do |article|
            .article.margin-b10
              %h4 #{link_to article.title, show_community_article_path(article.community, article)}
              .col
                %small #{article.created_at.strftime("%Y-%m-%d %H:%M:%S")}
              .col
                - if first_image_url(article.body)
                  .col.sizefit
                    .margin-r10
                      = image_tag first_image_url(article.body), size: "60x60"  
                .col.sizefill
                  %p #{truncate strip_tags(article.body), length: 140, omission: '.....'}
   

  :javascript
    $(document).ready(function(){
      var column = $("#widget_#{@column.id}");
      setWidget(column);
    });